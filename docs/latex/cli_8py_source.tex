\doxysection{cli.\+py}
\hypertarget{cli_8py_source}{}\label{cli_8py_source}\mbox{\hyperlink{cli_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00001}\mbox{\hyperlink{namespacecli}{00001}}\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00023}00023\ \textcolor{keyword}{import}\ socket}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00024}00024\ \textcolor{keyword}{import}\ os}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00025}00025\ \textcolor{keyword}{import}\ multiprocessing}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00026}00026\ \textcolor{keyword}{import}\ sys}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00027}00027\ \textcolor{keyword}{import}\ threading}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00028}00028\ \textcolor{keyword}{import}\ time}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00029}00029\ \textcolor{keyword}{from}\ datetime\ \textcolor{keyword}{import}\ datetime}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00031}00031\ \textcolor{keyword}{import}\ toml}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00032}00032\ \textcolor{keyword}{from}\ processes.discovery\ \textcolor{keyword}{import}\ discovery\_process}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00033}00033\ \textcolor{keyword}{from}\ processes.network\ \textcolor{keyword}{import}\ network\_process}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00035}\mbox{\hyperlink{namespacecli_aa2f0bc9f8733fb8bb200a8ffea0d6b2d}{00035}}\ CONFIG\_FILE\ =\ \textcolor{stringliteral}{"{}config.toml"{}}}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00037}00037\ \textcolor{comment}{\#\ ANSI\ escape\ codes\ for\ terminal\ colors}}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00038}\mbox{\hyperlink{namespacecli_a4de3a9a0d544aa9a554cd273612457cb}{00038}}\ COLOR\_RESET\ \ =\ \textcolor{stringliteral}{"{}\(\backslash\)033[0m"{}}}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00039}\mbox{\hyperlink{namespacecli_a31839bbe936d3cd82ffaf624e8fad2b7}{00039}}\ COLOR\_GREEN\ \ =\ \textcolor{stringliteral}{"{}\(\backslash\)033[92m"{}}}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00040}\mbox{\hyperlink{namespacecli_aae7123241d8e86b369fbfe2d35fd94fd}{00040}}\ COLOR\_RED\ \ \ \ =\ \textcolor{stringliteral}{"{}\(\backslash\)033[91m"{}}}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00041}\mbox{\hyperlink{namespacecli_a93a4049e836a2a323487c12f1ae5d446}{00041}}\ COLOR\_YELLOW\ =\ \textcolor{stringliteral}{"{}\(\backslash\)033[93m"{}}}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00042}00042\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00045}\mbox{\hyperlink{namespacecli_a83b773ef0d55a5629682c5a960c5367a}{00045}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacecli_a83b773ef0d55a5629682c5a960c5367a}{ts}}():}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00046}00046\ \ \ \ \ \textcolor{keywordflow}{return}\ datetime.now().strftime(\textcolor{stringliteral}{"{}[\%H:\%M:\%S]"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00047}00047\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00048}00048\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00052}\mbox{\hyperlink{namespacecli_a701551963d42fa00ce915e318c6c3bfc}{00052}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacecli_a701551963d42fa00ce915e318c6c3bfc}{port\_in\_use}}(port):}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00053}00053\ \ \ \ \ \textcolor{keyword}{with}\ socket.socket(socket.AF\_INET,\ socket.SOCK\_DGRAM)\ \textcolor{keyword}{as}\ s:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ \ \ \ \ s.bind((\textcolor{stringliteral}{"{}"{}},\ port))}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ OSError:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00058}00058\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00059}00059\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00060}00060\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00062}\mbox{\hyperlink{namespacecli_a8985492789245e09a948fb5b752d03da}{00062}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacecli_a8985492789245e09a948fb5b752d03da}{print\_commands}}():}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00063}00063\ \ \ \ \ print(\textcolor{stringliteral}{"{}\(\backslash\)nAvailable\ commands:"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00064}00064\ \ \ \ \ print(\textcolor{stringliteral}{"{}\ \ msg\ <handle>\ <text>"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00065}00065\ \ \ \ \ print(\textcolor{stringliteral}{"{}\ \ img\ <handle>\ <path\_to\_image>"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00066}00066\ \ \ \ \ print(\textcolor{stringliteral}{"{}\ \ clients"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00067}00067\ \ \ \ \ print(\textcolor{stringliteral}{"{}\ \ afk\ on|off"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00068}00068\ \ \ \ \ print(\textcolor{stringliteral}{"{}\ \ leave\(\backslash\)n"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00069}00069\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00070}00070\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00073}\mbox{\hyperlink{namespacecli_abd03877665d8dd3f485f589315964751}{00073}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacecli_abd03877665d8dd3f485f589315964751}{main}}():}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00074}00074\ \ \ \ \ cfg\_all\ =\ toml.load(CONFIG\_FILE)}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00075}00075\ \ \ \ \ clients\ =\ cfg\_all.get(\textcolor{stringliteral}{"{}clients"{}},\ [])}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00076}00076\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ clients:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}No\ [[clients]]\ section\ found\ in\ config.toml."{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ sys.exit(1)}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00079}00079\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00080}00080\ \ \ \ \ \textcolor{keywordflow}{if}\ len(sys.argv)\ !=\ 2:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00081}00081\ \ \ \ \ \ \ \ \ handles\ =\ [c[\textcolor{stringliteral}{"{}handle"{}}]\ \textcolor{keywordflow}{for}\ c\ \textcolor{keywordflow}{in}\ clients]}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00082}00082\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Usage:\ python\ cli.py\ <Handle>"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00083}00083\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Available\ handles:"{}},\ \textcolor{stringliteral}{"{},\ "{}}.join(handles))}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00084}00084\ \ \ \ \ \ \ \ \ sys.exit(1)}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00085}00085\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00086}00086\ \ \ \ \ chosen\ =\ sys.argv[1]}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00087}00087\ \ \ \ \ client\_index\ =\ next((i\ \textcolor{keywordflow}{for}\ i,\ c\ \textcolor{keywordflow}{in}\ enumerate(clients)\ \textcolor{keywordflow}{if}\ c[\textcolor{stringliteral}{"{}handle"{}}]\ ==\ chosen),\ \textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00088}00088\ \ \ \ \ \textcolor{keywordflow}{if}\ client\_index\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00089}00089\ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}Handle\ '\{chosen\}'\ not\ found."{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00090}00090\ \ \ \ \ \ \ \ \ sys.exit(1)}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00091}00091\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00092}00092\ \ \ \ \ \textcolor{comment}{\#\ Prepare\ client\ configuration\ and\ shared\ state}}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00093}00093\ \ \ \ \ config\ =\ clients[client\_index]}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00094}00094\ \ \ \ \ manager\ =\ multiprocessing.Manager()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00095}00095\ \ \ \ \ config[\textcolor{stringliteral}{"{}peers"{}}]\ =\ manager.list()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00096}00096\ \ \ \ \ config[\textcolor{stringliteral}{"{}\_\_cfg\_all"{}}]\ =\ cfg\_all}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00097}00097\ \ \ \ \ config[\textcolor{stringliteral}{"{}\_\_cfg\_index"{}}]\ =\ clients.index(config)}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00098}00098\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00099}00099\ \ \ \ \ \textcolor{comment}{\#\ Inter-\/process\ communication\ pipes}}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00100}00100\ \ \ \ \ ui2net\_p,\ ui2net\_c\ =\ multiprocessing.Pipe()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00101}00101\ \ \ \ \ net2ui\_p,\ net2ui\_c\ =\ multiprocessing.Pipe()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00102}00102\ \ \ \ \ disc\_ctrl\_parent,\ disc\_ctrl\_child\ =\ multiprocessing.Pipe()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00103}00103\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00104}00104\ \ \ \ \ \textcolor{comment}{\#\ Start\ discovery\ process\ if\ not\ already\ running}}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00105}00105\ \ \ \ \ p\_disc\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00106}00106\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ \mbox{\hyperlink{namespacecli_a701551963d42fa00ce915e318c6c3bfc}{port\_in\_use}}(config[\textcolor{stringliteral}{"{}whoisport"{}}]):}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ p\_disc\ =\ multiprocessing.Process(target=discovery\_process,\ args=(config,\ disc\_ctrl\_child))}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00108}00108\ \ \ \ \ \ \ \ \ p\_disc.start()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00109}00109\ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}[INFO]\ Discovery\ service\ started\ on\ port\ \{config['whoisport']\}"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00110}00110\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00111}00111\ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}[INFO]\ Discovery\ already\ running\ on\ port\ \{config['whoisport']\}"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00112}00112\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00113}00113\ \ \ \ \ \textcolor{comment}{\#\ Start\ network\ process}}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00114}00114\ \ \ \ \ p\_net\ =\ multiprocessing.Process(target=network\_process,\ args=(config,\ ui2net\_c,\ net2ui\_p))}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00115}00115\ \ \ \ \ p\_net.start()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00116}00116\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00117}00117\ \ \ \ \ stop\_event\ =\ threading.Event()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00118}00118\ \ \ \ \ left\_peers\ =\ set()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00119}00119\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00120}00120\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00122}00122\ \ \ \ \ \textcolor{keyword}{def\ }poll\_network():}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ \textcolor{keywordflow}{not}\ stop\_event.is\_set():}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00124}00124\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ net2ui\_c.poll():}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ typ,\ src,\ payload\ =\ net2ui\_c.recv()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00126}00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ typ\ ==\ \textcolor{stringliteral}{'MSG'}:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00127}00127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}\(\backslash\)n\{COLOR\_GREEN\}\{ts()\}\ [\{src\}]\ \{payload\}\{COLOR\_RESET\}\(\backslash\)n"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00128}00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ typ\ ==\ \textcolor{stringliteral}{'IMG'}:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00129}00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}\(\backslash\)n\{COLOR\_YELLOW\}\{ts()\}\ [\{src\}]\ sent\ image\ →\ \{payload\}\{COLOR\_RESET\}\(\backslash\)n"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00130}00130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ typ\ ==\ \textcolor{stringliteral}{'LEAVE'}:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00131}00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ src\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ left\_peers:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00132}00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}\(\backslash\)n\{COLOR\_RED\}\{ts()\}\ [\{src\}]\ left\ the\ chat.\{COLOR\_RESET\}\(\backslash\)n"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ left\_peers.add(src)}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ config[\textcolor{stringliteral}{'peers'}][:]\ =\ [p\ \textcolor{keywordflow}{for}\ p\ \textcolor{keywordflow}{in}\ config[\textcolor{stringliteral}{'peers'}]\ \textcolor{keywordflow}{if}\ p[0]\ !=\ src]}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00135}00135\ \ \ \ \ \ \ \ \ \ \ \ \ time.sleep(0.05)}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00136}00136\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00137}00137\ \ \ \ \ threading.Thread(target=poll\_network,\ daemon=\textcolor{keyword}{True}).start()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00138}00138\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00139}00139\ \ \ \ \ print(f\textcolor{stringliteral}{"{}\(\backslash\)n==========\ SLCP\ CLI\ Chat\ started\ as\ '\{chosen\}'\ =========="{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00140}00140\ \ \ \ \ \mbox{\hyperlink{namespacecli_a8985492789245e09a948fb5b752d03da}{print\_commands}}()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00141}00141\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00142}00142\ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ \textcolor{keyword}{True}:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ \ \ \ \ cmd\ =\ input(\textcolor{stringliteral}{"{}>\ "{}}).strip()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00145}00145\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ cmd:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00146}00146\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00147}00147\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00148}00148\ \ \ \ \ \ \ \ \ \ \ \ \ parts\ =\ cmd.split(\textcolor{stringliteral}{"{}\ "{}},\ 2)}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00149}00149\ \ \ \ \ \ \ \ \ \ \ \ \ action\ =\ parts[0].lower()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00150}00150\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00151}00151\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ action\ ==\ \textcolor{stringliteral}{"{}leave"{}}:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00152}00152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}Sending\ LEAVE..."{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00153}00153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ui2net\_p.send((\textcolor{stringliteral}{"{}LEAVE"{}},\ \textcolor{stringliteral}{"{}"{}},\ \textcolor{stringliteral}{"{}"{}}))}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00154}00154\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00155}00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ p\_disc:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00156}00156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ disc\_ctrl\_parent.send(\textcolor{stringliteral}{"{}STOP"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00157}00157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p\_disc.join()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00158}00158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}[INFO]\ Discovery\ stopped."{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00159}00159\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00160}00160\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ui2net\_p.send((\textcolor{stringliteral}{"{}EXIT"{}},\ \textcolor{stringliteral}{"{}"{}},\ \textcolor{stringliteral}{"{}"{}}))}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00161}00161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p\_net.join()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00162}00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stop\_event.set()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00163}00163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ time.sleep(0.1)}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00164}00164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00165}00165\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00166}00166\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ action\ ==\ \textcolor{stringliteral}{"{}clients"{}}:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00167}00167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ peers\ =\ [(h,\ ip,\ pt)\ \textcolor{keywordflow}{for}\ (h,\ ip,\ pt)\ \textcolor{keywordflow}{in}\ config[\textcolor{stringliteral}{'peers'}]\ \textcolor{keywordflow}{if}\ h\ !=\ chosen]}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00168}00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ peers:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00169}00169\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}No\ other\ clients\ found."{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00170}00170\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00171}00171\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}\(\backslash\)nActive\ clients:"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00172}00172\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (h,\ ip,\ pt)\ \textcolor{keywordflow}{in}\ peers:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00173}00173\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}\ \ \{h\}\ (\{ip\}:\{pt\})"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00174}00174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00175}00175\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00176}00176\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ action\ ==\ \textcolor{stringliteral}{"{}msg"{}}\ \textcolor{keywordflow}{and}\ len(parts)\ >=\ 3:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00177}00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dest\ =\ parts[1]}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00178}00178\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ msg\ =\ parts[2]}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00179}00179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ui2net\_p.send((\textcolor{stringliteral}{"{}MSG"{}},\ dest,\ msg))}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00180}00180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}[SEND]\ to\ \{dest\}:\ \{msg\}"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00181}00181\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00182}00182\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ action\ ==\ \textcolor{stringliteral}{"{}img"{}}\ \textcolor{keywordflow}{and}\ len(parts)\ >=\ 3:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00183}00183\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dest\ =\ parts[1]}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00184}00184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ path\ =\ parts[2]}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00185}00185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ os.path.isfile(path):}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00186}00186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}[ERROR]\ File\ not\ found:\ \{path\}"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00187}00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00188}00188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ui2net\_p.send((\textcolor{stringliteral}{"{}IMG"{}},\ dest,\ path))}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00189}00189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}[SEND\ IMG]\ to\ \{dest\}:\ \{path\}"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00190}00190\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00191}00191\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ action\ ==\ \textcolor{stringliteral}{"{}afk"{}}\ \textcolor{keywordflow}{and}\ len(parts)\ ==\ 2:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00192}00192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mode\ =\ parts[1].lower()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00193}00193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ mode\ \textcolor{keywordflow}{in}\ (\textcolor{stringliteral}{"{}on"{}},\ \textcolor{stringliteral}{"{}off"{}}):}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00194}00194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ui2net\_p.send((\textcolor{stringliteral}{"{}AFK"{}},\ chosen,\ mode.upper()))}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00195}00195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}[AFK]\ set\ to\ \{mode.upper()\}"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00196}00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00197}00197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}[ERROR]\ Usage:\ afk\ on|off"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00198}00198\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00199}00199\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ action\ ==\ \textcolor{stringliteral}{"{}help"{}}:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00200}00200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacecli_a8985492789245e09a948fb5b752d03da}{print\_commands}}()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00201}00201\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00202}00202\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00203}00203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}[ERROR]\ Unknown\ command.\ Type\ 'help'\ for\ commands."{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00204}00204\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00205}00205\ \ \ \ \ \ \ \ \ \ \ \ \ time.sleep(0.05)}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00206}00206\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00207}00207\ \ \ \ \ \textcolor{keywordflow}{finally}:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00208}00208\ \ \ \ \ \ \ \ \ stop\_event.set()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00209}00209\ \ \ \ \ \ \ \ \ time.sleep(0.1)}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00210}00210\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00211}00211\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ p\_disc:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00212}00212\ \ \ \ \ \ \ \ \ \ \ \ \ disc\_ctrl\_parent.send(\textcolor{stringliteral}{"{}STOP"{}})}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00213}00213\ \ \ \ \ \ \ \ \ \ \ \ \ p\_disc.join()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00214}00214\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00215}00215\ \ \ \ \ \ \ \ \ ui2net\_p.send((\textcolor{stringliteral}{"{}EXIT"{}},\ \textcolor{stringliteral}{"{}"{}},\ \textcolor{stringliteral}{"{}"{}}))}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00216}00216\ \ \ \ \ \ \ \ \ p\_net.join()}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00217}00217\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00218}00218\ }
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00219}00219\ \textcolor{keywordflow}{if}\ \_\_name\_\_\ ==\ \textcolor{stringliteral}{"{}\_\_main\_\_"{}}:}
\DoxyCodeLine{\Hypertarget{cli_8py_source_l00220}00220\ \ \ \ \ \mbox{\hyperlink{namespacemain}{main}}()}

\end{DoxyCode}
